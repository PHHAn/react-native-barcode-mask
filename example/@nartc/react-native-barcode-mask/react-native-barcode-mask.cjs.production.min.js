"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react-native"),n=require("react"),o=e(n),i=require("react-native-reanimated"),r=e(i),a=require("react-native-camera");function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var u=r.Value,c=r.Clock,s=r.block,h=r.cond,l=r.set,f=r.startClock,g=r.timing,m=r.eq,p=function(){},b=n.memo((function(e){var n=e.width,i=e.height,a=e.startValue,u=e.destinationValue,s=e.backgroundColor,h=e.edgeBorderWidth,l=e.edgeColor,f=e.edgeHeight,g=e.edgeWidth,m=e.edgeRadius,b=e.maskOpacity,R=e.animatedLineColor,w=e.animatedLineOrientation,v=e.animatedLineThickness,C=e.animationDuration,L=e.showAnimatedLine,B=e.runTimingFn,k=e.onLayoutChange,x=e.outerBoundingRect,O=e.onOuterLayout,W=function(e,t){var n,o=null!==(n=null==x?void 0:x[t])&&void 0!==n?n:0;return e?"number"==typeof e?.9*e:e.endsWith("%")?Number(e.split("%")[0])/100*o*.9:Number(e.split(/\d+/)[0])*o*.9:.9*o},E=function(e,t){return W(e,t)/.9-v},T=function(){return{backgroundColor:s,opacity:b,flex:1}},V=function(e){return o.createElement(t.View,{style:d({},{width:g,height:f,borderColor:l,zIndex:2},{},y[e],{},{topRight:{borderRightWidth:h,borderTopWidth:h,borderTopRightRadius:m,top:-h,right:-h},topLeft:{borderTopWidth:h,borderLeftWidth:h,borderTopLeftRadius:m,top:-h,left:-h},bottomRight:{borderBottomWidth:h,borderRightWidth:h,borderBottomRightRadius:m,bottom:-h,right:-h},bottomLeft:{borderBottomWidth:h,borderLeftWidth:h,borderBottomLeftRadius:m,bottom:-h,left:-h}}[e])})},N=W(n,"width")/.9,F=W(i,"height")/.9;return o.createElement(t.View,{style:y.container},o.createElement(t.View,{style:d({},y.finder,{width:N,height:F}),onLayout:k||p},V("topLeft"),V("topRight"),V("bottomLeft"),V("bottomRight"),L&&o.createElement(r.View,{style:function(){if("horizontal"===w){var e=W(n,"width"),t=E(i,"height");return d({},y.animatedLine,{height:v,width:e,backgroundColor:R,top:B(new c,a||0,u||t,C)})}var o=W(i,"height"),r=E(n,"width");return d({},y.animatedLine,{width:v,height:o,backgroundColor:R,left:B(new c,a||0,u||r,C)})}()})),o.createElement(t.View,{style:y.maskOuter,onLayout:O||p},o.createElement(t.View,{style:d({},y.maskRow,{},T())}),o.createElement(t.View,{style:d({height:i},y.maskCenter)},o.createElement(t.View,{style:T()}),o.createElement(t.View,{style:d({},y.maskInner,{width:n,height:i,borderRadius:m})}),o.createElement(t.View,{style:T()})),o.createElement(t.View,{style:d({},y.maskRow,{},T())})))}));b.defaultProps={width:280,height:230,edgeWidth:20,edgeHeight:20,edgeColor:"#fff",edgeBorderWidth:4,edgeRadius:0,backgroundColor:"#eee",maskOpacity:1,animatedLineColor:"#fff",animatedLineOrientation:"horizontal",animatedLineThickness:2,animationDuration:2e3,runTimingFn:function(e,t,n,o){var r={finished:new u(0),position:new u(t),time:new u(0),frameTime:new u(0)},a={duration:o,toValue:new u(n),easing:i.Easing.inOut(i.Easing.ease)};return s([f(e),g(e,r,a),h(r.finished,[l(r.finished,0),l(r.time,0),l(r.frameTime,0),l(r.position,h(m(r.position,n),n,t)),l(a.toValue,h(m(r.position,n),t,n))]),r.position])},showAnimatedLine:!0};var y=t.StyleSheet.create({container:d({alignItems:"center",justifyContent:"center"},t.StyleSheet.absoluteFillObject),finder:{alignItems:"center",justifyContent:"center",zIndex:1},maskOuter:{position:"absolute",top:0,left:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"space-around"},maskInner:{backgroundColor:"transparent"},maskRow:{width:"100%"},maskCenter:{flexDirection:"row",display:"flex"},topLeft:{position:"absolute",top:0,left:0},topRight:{position:"absolute",top:0,right:0},bottomLeft:{position:"absolute",bottom:0,left:0},bottomRight:{position:"absolute",bottom:0,right:0},animatedLine:{position:"absolute",zIndex:1}}),R=function(e){var t,i=e.displayName||e.name||"Component";return(t=function(t){var n,i;function r(){var e;return(e=t.apply(this,arguments)||this).state={boundingRect:{x:0,y:0,width:0,height:0}},e.onOuterLayout=function(t){e.setState({boundingRect:t.nativeEvent.layout})},e}return i=t,(n=r).prototype=Object.create(i.prototype),n.prototype.constructor=n,n.__proto__=i,r.prototype.render=function(){return o.createElement(e,Object.assign({outerBoundingRect:this.state.boundingRect,onOuterLayout:this.onOuterLayout},this.props))},r}(n.PureComponent)).displayName="withOuterLayout"+i,t},w=function(e,t,o){var i,r=n.useState(!1),a=r[0],u=r[1],c=n.useReducer((function(e,t){switch(t.type){case"SET":return d({},e,{},t.payload);default:return e}}),{width:0,height:0,x:0,y:0}),s=c[0],h=c[1],l=n.useCallback((function(e){var t=e.nativeEvent.layout;h({type:"SET",payload:{height:t.height,width:t.width,x:t.x,y:t.y}})}),[s.height,s.width,s.x,s.y]),f=0;return!o||o&&"number"==typeof o?(f&&clearTimeout(f),i=function(n){u(!0),t(e(n)),f=setTimeout((function(){u(!1)}),o)}):i=function(n){var i,r;null==o||null===(i=o.beforeScan)||void 0===i||i.call(o),t(e(n)),null==o||null===(r=o.afterScan)||void 0===r||r.call(o)},{barcodeRead:o&&"object"==typeof o?null:a,finderX:s.x,finderY:s.y,finderWidth:s.width,finderHeight:s.height,onBarcodeFinderLayoutChange:l,processingReadBarcode:i}},v=t.Platform.select({android:function(e,o,i,r,d,u,c){return n.useCallback((function(n){if(o&&!e){var s=n.bounds.origin.map((function(e){return{x:Number(e.x)/t.PixelRatio.get(),y:Number(e.y)/t.PixelRatio.get()}})),h=function(e){var t=e.x,n=e.y;return t>=i&&t<=i+d&&n>=r&&n<=r+u};if(n.type===a.RNCamera.Constants.BarCodeType.pdf417){var l=s[1],f=s[2],g=s[3];if(h(s[0])&&h(l)&&h(f)&&h(g))return void c(n.data)}if(n.type===a.RNCamera.Constants.BarCodeType.qr){var m=s[1],p=s[2],b=s[3];if(h(s[0])&&h(m)&&h(p)&&h(b))return void c(n.data)}}}),[e,o,i,r,d,u,c])},ios:function(e,t,o,i,r,a,d){return n.useCallback((function(n){if(t&&!e){var u=n.bounds,c=u.origin,s=c.x,h=c.y,l=u.size,f=l.width,g=l.height;return Number(s)>=o&&Number(s)+Number(f)<=o+r&&Number(h)>=i&&Number(h)+Number(g)<=i+a?d(n.data):void 0}}),[e,t,o,i,r,a,d])}}),C=t.Platform.select({android:function(e,t,n,o){void 0===o&&(o=500);var i=w(t,n,o),r=i.barcodeRead,a=i.onBarcodeFinderLayoutChange;return{barcodeRead:r,onBarcodeRead:v(null!=r&&r,e,i.finderX,i.finderY,i.finderWidth,i.finderHeight,i.processingReadBarcode),onBarcodeFinderLayoutChange:a}},ios:function(e,t,n,o){void 0===o&&(o=500);var i=w(t,n,o),r=i.barcodeRead,a=i.onBarcodeFinderLayoutChange;return{barcodeRead:r,onBarcodeRead:v(null!=r&&r,e,i.finderX,i.finderY,i.finderWidth,i.finderHeight,i.processingReadBarcode),onBarcodeFinderLayoutChange:a}}}),L=t.Platform.select({android:function(e,t,n,o,i){var r=w(t,n,o),a=r.barcodeRead,d=r.onBarcodeFinderLayoutChange,u=r.finderY,c=r.finderX,s=r.finderWidth,h=r.finderHeight,l=r.processingReadBarcode;return{barcodeRead:a,onBarcodeRead:i?i({x:c,y:u,width:s,height:h},l):v(null!=a&&a,e,c,u,s,h,l),onBarcodeFinderLayoutChange:d}},ios:function(e,t,n,o,i){var r=w(t,n,o),a=r.barcodeRead,d=r.onBarcodeFinderLayoutChange,u=r.finderHeight,c=r.finderWidth,s=r.finderX,h=r.finderY,l=r.processingReadBarcode;return{barcodeRead:a,onBarcodeRead:i?i({x:s,y:h,width:c,height:u},l):v(null!=a&&a,e,s,h,c,u,l),onBarcodeFinderLayoutChange:d}}}),B=R(b);exports.BarcodeMask=b,exports.BarcodeMaskWithOuterLayout=B,exports.useBarcodeRead=C,exports.useCustomBarcodeRead=L,exports.withOuterLayout=R;
//# sourceMappingURL=react-native-barcode-mask.cjs.production.min.js.map
